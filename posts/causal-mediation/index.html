<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_lanyon.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=icon  href="/assets/logo.jpg"> <title>Causal Mediation</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>A theme adapted from <a href="http://lanyon.getpoole.com/" target=_blank >Lanyon</a>.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/about">About</a> <a class="sidebar-nav-item " href="/contact">Contact</a> </nav> <div class=sidebar-item > <p>&copy; Oisin Fitzgerald.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/" title=Home >A data science blog</a> </h3> </div> </div> <div class="container content"> <div class=franklin-content ><h1 id=causal_mediation_a_brief_overview ><a href="#causal_mediation_a_brief_overview" class=header-anchor >Causal Mediation: A Brief Overview</a></h1> <p>Oisín Fitzgerald, March 2021</p> <div class=boxed >I recently worked on the meta-analysis of a set of randomised control trials &#40;RCT&#41;, and as part of this carried out a series of causal mediation analyses. I&#39;d never thought about mediation in an RCT setting before. It was interesting to realise that even in a perfectly designed experiment with full randomisation of the treatment there is a need to think carefully about risk of confounding.</div> <h2 id=introduction ><a href="#introduction" class=header-anchor >Introduction</a></h2> <p>As described by Judea Pearl causal mediation is an attempt to explain how nature works. It attempts to quantify the extent to which the effect of an action &#40;the treatment&#41; on a outcome of interest can be explained by a particular mechanism &#40;the mediator&#41;. Of course, the extent to which we are &quot;explaining nature&quot; is necessarily limited by the data available. As an example exercise may reduce an individuals risk of dementia because it reduces blood pressure. A <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">directed acyclic graph</a> that encodes this structure is shown below. This graph says that exercise impacts risk of dementia <strong>indirectly</strong> through changes in blood pressure and also <strong>directly</strong>, possibly through some other unmeasured mechanism.</p> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/mediation1.png" style="padding:0; width:100%" alt=" Example of mediation."/> <figcaption> Example of mediation.</figcaption> </figure> <p>There are several effects of interest in a mediation analysis, relating to which pathway &#40;direct/indirect&#41; and node &#40;treatment/mediator&#41; we wish to consider intervening on and if we want to imagine keeping some aspect of the treatment fixed at a baseline/control level. Some notation, there are two treatment levels <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∈</mo><mo stretchy=false >{</mo><mn>0</mn><mo separator=true >,</mo><mn>1</mn><mo stretchy=false >}</mo></mrow><annotation encoding="application/x-tex">A \in \{0,1\}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >{</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mord >1</span><span class=mclose >}</span></span></span></span> with an outcome <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>, and potential outcome <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Y(a)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span></span></span></span>, the outcome observed if we set <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>a</mi></mrow><annotation encoding="application/x-tex">A = a</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span>. By consistency, in our observed data <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Y = Y(1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span></span></span></span> if <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A = 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> and similarly for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">A = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span>. The mediator <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> also has potential outcomes <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">M(0)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">M(1)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span></span></span></span>. Within mediation analysis there is a second potential outcome <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo stretchy=false >(</mo><mi>a</mi><mo separator=true >,</mo><mi>m</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Y(a,m)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">m</span><span class=mclose >)</span></span></span></span> that arises if we consider setting both <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> to particular values. This potential outcome also allows us consider questions such as: what value would the outcome take if an individual is treated <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> but the treatment-mediator pathway is &quot;broken&quot; <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">M=M(0)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)</span></span></span></span> denoted as <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">Y(1,M(0))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >))</span></span></span></span>. Other variables will be denoted <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span>, ... as required. I generally assume some level of familiarity with causal inference, a good introduction is <a href="https://www.hsph.harvard.edu/miguel-hernan/causal-inference-book/">Hernan and Robin&#39;s book</a>. </p> <p>Some other examples of the type of questions for which causal mediation analysis is useful: </p> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/mediation2.png" style="padding:0; width:100%" alt=" Three examples of mediation."/> <figcaption> Three examples of mediation.</figcaption> </figure> <h2 id=quantities_of_interest ><a href="#quantities_of_interest" class=header-anchor >Quantities of interest </a></h2> <p>There are several quantities &#40;statistical/causal estimands&#41; of interest in a mediation analysis. The naming conventions are different depending on the literature I&#39;ve read and here I stick with Pearl &#40;2014&#41;.</p> <h3 id=total_effect ><a href="#total_effect" class=header-anchor >Total effect</a></h3> <p>The total effect is the change in the outcome if we flip the treatment switch and aren&#39;t concerned with the mechanism of action. It is the usual average treatment effect figure we might expect to see in the headline results of an RCT. We could collapse the graph below into <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">A \rightarrow Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>TE</mtext><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\text{TE} = E(Y(1) - Y(0))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class=mord >TE</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >))</span></span></span></span> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/totaleffect.png" style="padding:0; width:100%" alt=" Total effect"/> <figcaption> Total effect</figcaption> </figure> <h3 id=direct_effect ><a href="#direct_effect" class=header-anchor >Direct effect</a></h3> <p>The natural direct effect is the effect of flipping the treatment switch if we imagine that the indirect pathway is no longer operational.</p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>DE</mtext><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\text{DE} = E(Y(1,M(0)) - Y(0,M(0)))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class=mord >DE</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >))</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span></span></span></span> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/directeffect.png" style="padding:0; width:100%" alt=" Direct effect"/> <figcaption> Direct effect</figcaption> </figure> <h3 id=indirect_effect ><a href="#indirect_effect" class=header-anchor >Indirect effect</a></h3> <p>The natural direct effect &#40;or average mediated effect&#41; is the effect of flipping the treatment switch if we imagine that the direct pathway is no longer operational. </p> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>IDE</mtext><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">\text{IDE} = E(Y(0,M(1)) - Y(0,M(0)))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class=mord >IDE</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >))</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span></span></span></span> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/indirecteffect.png" style="padding:0; width:100%" alt=" Indirect effect"/> <figcaption> Indirect effect</figcaption> </figure> <p>Each of these effects may be useful for different purposes. For example, the total effect may guide immediate decision making and policy - if a treatment works and is immediately needed the mechanism of action is less important. The size of the indirect effect is useful information for considering alternative &#40;e.g. cheaper&#41; treatments that target the mediator. The value <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>IDE</mtext><mi mathvariant=normal >/</mi><mtext>TE</mtext></mrow><annotation encoding="application/x-tex">\text{IDE}/\text{TE}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class=mord >IDE</span></span><span class=mord >/</span><span class="mord text"><span class=mord >TE</span></span></span></span></span> is considered the percentage of the total effect explained by the mediator. </p> <h2 id=mediation_and_exchangeability ><a href="#mediation_and_exchangeability" class=header-anchor >Mediation and exchangeability</a></h2> <p>One of the important considerations in any causal analysis is exchangeability/ignorability. Also referred to as unconfoundedness, we can think of exchangeability as meaning that individuals in either treatment arm are literally a-priori exchangeable or &quot;swappable&quot;, with the conditionaly exchangeability meaning that individuals are swappable within strata of a covariates X. We want our analysis to be comparable to a RCT, you could have ended up in either treatment arm. What exchangeability achieves is a lack of dependence between the treatment assignment and the potential outcome under that treatment <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>⊥</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">Y(a) \perp A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⊥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span>. Otherwise you end up with flawed analysis. </p> <h3 id=a_more_detailed_example_if_you_want ><a href="#a_more_detailed_example_if_you_want" class=header-anchor >A more detailed example &#40;if you want&#41;</a></h3> <p>For example, assume that in truth exercise <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> reduces risk of hospitalisations due to asthma <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span>, and we wish in practise to investigate the link using survey of all asthmatics who have attended a clinic. However, only mild asthmatics do any exercise training &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A=1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>&#41; and already have fairly low risk of hospitalisations. So a naive analysis might find that exercise increases risk of hospitalisations. We have set up a scenario where our naive treatment estimator cannot equal the true treatment effect <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mo>−</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mo mathvariant=normal >≠</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">E(Y|A=1) - E(Y|A=0) \ne E(Y(1) - Y(0))</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >0</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel ><span class=mrel ><span class="mord vbox"><span class=thinbox ><span class=rlap ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class=inner ><span class=mord ><span class=mrel ></span></span></span><span class=fix ></span></span></span></span></span><span class=mrel >=</span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >))</span></span></span></span>. Clearly severity of asthma <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> would be an important adjustment and we might be happy to consider treatment assigment random within levels of an asthma severity measure <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> leading to conditional exchangeability <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo stretchy=false >(</mo><mi>a</mi><mo stretchy=false >)</mo><mo>⊥</mo><mi>A</mi><mi mathvariant=normal >∣</mi><mi>X</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">Y(a) \perp A | X = x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class="mord mathnormal">a</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >⊥</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span>. </p> <h3 id=confounding_in_rcts ><a href="#confounding_in_rcts" class=header-anchor >Confounding in RCTs</a></h3> <p>Now that we&#39;ve recapped exchangeability in general lets consider it for mediation. In particular I&#39;m going to talk about RCTs and so will assume the initial treatment <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span></span></span></span> is fully randomised and unconfounded. An issue here is rather simply that we&#39;ve randomised only the treatment and not the mediator, and so any mediation analysis can still be confounded. For example, we could randomise exercise training to assess if that reduces asthma hospitalisations, with the potential mechanism of interest being a reduction in inflammation. However, maybe our study is in a district with poor industrial pollution controls. Some individuals in our study happen to live near a factory that is unbeknownst to them leaking a pollutant that raises lung inflammtion and increasing their our risk of asthma hospitalisation. As a result we have a partially confounded analysis, there is an unrecorded factor - proximity to the factory - that we won&#39;t account for in the analysis. What will happen then is that estimates of the indirect and direct effects will be biased away from the true effect. </p> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/mediation3.png" style="padding:0; width:100%" alt=" Mediation with confounding"/> <figcaption> Mediation with confounding</figcaption> </figure> <h2 id=simulations ><a href="#simulations" class=header-anchor >Simulations </a></h2> <p>Let&#39;s investigate this issue around confounding and mediation analysis using some simple linear forms for our data generation process and models. Feel free to skim the maths, all that matters is that the effects of interest turn out to be coefficients we can easily extract from a linear model. </p> <h3 id=0_an_unconfounded_mediation_model ><a href="#0_an_unconfounded_mediation_model" class=header-anchor >&#40;0&#41; An unconfounded mediation model</a></h3> <p>First lets clarify what we are attempting to estimate.</p> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/mediationlinear.png" style="padding:0; width:100%" alt=" Linear mediation model (structural equation model): scenario 0"/> <figcaption> Linear mediation model (structural equation model): scenario 0</figcaption> </figure> <p>Assuming no confounding in our generative model we can estimate the total, direct and indirect effects using estimators of the following quantities, for the total effect we have </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.2500em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mtext>TE</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mo>−</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>M</mi><mo>=</mo><mi>m</mi><mo separator=true >,</mo><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mo>−</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>M</mi><mo>=</mo><mi>m</mi><mo separator=true >,</mo><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>γ</mi><mo>∗</mo><mi>E</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mo>+</mo><mi>β</mi><mo>−</mo><mi>γ</mi><mo>∗</mo><mi>E</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>γ</mi><mo>∗</mo><mi>α</mi><mo>+</mo><mi>β</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \text{TE} &amp;= E(Y(1) - Y(0)) \\ &amp;= E(Y|A=1) - E(Y|A=0) \\ &amp;= \int_{\mathcal{M}} E(Y|M=m,A=1)p(M|A=1) - \int_{\mathcal{M}} E(Y|M=m,A=0)p(M|A=0) \\ &amp;= \gamma*E(M|A=1) + \beta - \gamma*E(M|A=0) \\ &amp;= \gamma*\alpha + \beta \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:8.571950000000001em;vertical-align:-4.0359750000000005em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:4.5359750000000005em;"><span style="top:-7.055975000000001em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class="mord text"><span class=mord >TE</span></span></span></span><span style="top:-5.555975em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-3.5359749999999996em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-1.484025em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:0.015975000000000072em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.0359750000000005em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:4.5359750000000005em;"><span style="top:-7.055975000000001em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >))</span></span></span><span style="top:-5.555975em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span><span style="top:-3.5359749999999996em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span><span style="top:-1.484025em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span></span></span><span style="top:0.015975000000000072em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.0359750000000005em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>And the direct effect we have</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.2500em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mtext>DE</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>1</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>−</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>M</mi><mo>=</mo><mi>m</mi><mo separator=true >,</mo><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi><mo>−</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>M</mi><mo>=</mo><mi>m</mi><mo separator=true >,</mo><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mo stretchy=false >(</mo><mi>γ</mi><mo>∗</mo><mi>m</mi><mo>+</mo><mi>β</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi><mo>−</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mo stretchy=false >(</mo><mi>γ</mi><mo>∗</mo><mi>m</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>β</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \text{DE} &amp;= E(Y(1,M(0)) - Y(0,M(0))) \\ &amp;= E(Y(1,M(0))) - E(Y(0,M(0))) \\ &amp;= \int_{\mathcal{M}} E(Y|M=m,A=1)p(M|A=0) dm - \int_{\mathcal{M}} E(Y|M=m,A=0)p(M|A=0) dm \\ &amp;= \int_{\mathcal{M}} (\gamma*m + \beta) p(M|A=0) dm - \int_{\mathcal{M}} (\gamma*m) p(M|A=0) dm \\ &amp;= \beta \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:9.643900000000002em;vertical-align:-4.571950000000001em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:5.07195em;"><span style="top:-7.591950000000001em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class="mord text"><span class=mord >DE</span></span></span></span><span style="top:-6.09195em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-4.071949999999999em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-1.4999999999999991em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:0.5519500000000006em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.571950000000001em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:5.07195em;"><span style="top:-7.591950000000001em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >))</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span></span></span><span style="top:-6.09195em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >1</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span></span></span><span style="top:-4.071949999999999em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span><span style="top:-1.4999999999999991em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">m</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span><span style="top:0.5519500000000006em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:4.571950000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>And the indirect effect we have </p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mtable rowspacing=0.2500em  columnalign="right left" columnspacing=0em ><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mtext>IDE</mtext></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>−</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>1</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo>−</mo><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mo stretchy=false >(</mo><mn>0</mn><mo separator=true >,</mo><mi>M</mi><mo stretchy=false >(</mo><mn>0</mn><mo stretchy=false >)</mo><mo stretchy=false >)</mo><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>M</mi><mo>=</mo><mi>m</mi><mo separator=true >,</mo><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi><mo>−</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mi>E</mi><mo stretchy=false >(</mo><mi>Y</mi><mi mathvariant=normal >∣</mi><mi>M</mi><mo>=</mo><mi>m</mi><mo separator=true >,</mo><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mo stretchy=false >(</mo><mi>γ</mi><mo>∗</mo><mi>m</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi><mo>−</mo><msub><mo>∫</mo><mi mathvariant=script >M</mi></msub><mo stretchy=false >(</mo><mi>γ</mi><mo>∗</mo><mi>m</mi><mo stretchy=false >)</mo><mi>p</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>0</mn><mo stretchy=false >)</mo><mi>d</mi><mi>m</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>γ</mi><mo>∗</mo><mi>E</mi><mo stretchy=false >(</mo><mi>M</mi><mi mathvariant=normal >∣</mi><mi>A</mi><mo>=</mo><mn>1</mn><mo stretchy=false >)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=0  displaystyle=true ><mrow><mrow></mrow><mo>=</mo><mi>γ</mi><mo>∗</mo><mi>α</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned} \text{IDE} &amp;= E(Y(0,M(1)) - Y(0,M(0))) \\ &amp;= E(Y(0,M(1))) - E(Y(0,M(0))) \\ &amp;= \int_{\mathcal{M}} E(Y|M=m,A=0)p(M|A=1) dm - \int_{\mathcal{M}} E(Y|M=m,A=0)p(M|A=0) dm \\ &amp;= \int_{\mathcal{M}} (\gamma*m) p(M|A=1) dm - \int_{\mathcal{M}} (\gamma*m) p(M|A=0) dm \\ &amp;= \gamma * E(M|A=1) \\ &amp;= \gamma * \alpha \end{aligned}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:11.143900000000002em;vertical-align:-5.321950000000001em;"></span><span class=mord ><span class=mtable ><span class=col-align-r ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:5.82195em;"><span style="top:-8.34195em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class="mord text"><span class=mord >IDE</span></span></span></span><span style="top:-6.84195em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-4.821949999999999em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-2.249999999999999em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:-0.1980499999999994em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span><span style="top:1.3019500000000006em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:5.321950000000001em;"><span></span></span></span></span></span><span class=col-align-l ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:5.82195em;"><span style="top:-8.34195em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >))</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span></span></span><span style="top:-6.84195em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >1</span><span class=mclose >)))</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mopen >(</span><span class=mord >0</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mopen >(</span><span class=mord >0</span><span class=mclose >)))</span></span></span><span style="top:-4.821949999999999em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class=mord >∣</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span><span style="top:-2.249999999999999em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">m</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mop ><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:-0.433619em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight">M</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">m</span><span class=mclose >)</span><span class="mord mathnormal">p</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >0</span><span class=mclose >)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span></span></span><span style="top:-0.1980499999999994em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class=mopen >(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=mord >∣</span><span class="mord mathnormal">A</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord >1</span><span class=mclose >)</span></span></span><span style="top:1.3019500000000006em;"><span class=pstrut  style="height:3.3600000000000003em;"></span><span class=mord ><span class=mord ></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >∗</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:5.321950000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span> <p>We&#39;ll estimate these coefficients using R&#39;s <code>lm</code> function. Obviously in reality we&#39;d need to worry about whether a linear model is the appropriate functional form for our analyses, see Pearl &#40;2014&#41; for details more general versions of these formulas. From the graph below we see that in the unconfounded case we have unbiased estimates of our parameters - as expected&#33; </p> <pre><code class="r hljs">mediation_scen0 <span class=hljs-operator >&lt;-</span> <span class=hljs-keyword >function</span><span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >,</span>alpha<span class=hljs-punctuation >,</span>beta<span class=hljs-punctuation >,</span><span class=hljs-built_in >gamma</span><span class=hljs-punctuation >)</span> <span class=hljs-punctuation >{</span>
  A <span class=hljs-operator >&lt;-</span> rbinom<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >,</span><span class=hljs-number >1</span><span class=hljs-punctuation >,</span><span class=hljs-number >0.5</span><span class=hljs-punctuation >)</span>
  M <span class=hljs-operator >&lt;-</span> alpha<span class=hljs-operator >*</span>A <span class=hljs-operator >+</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  Y <span class=hljs-operator >&lt;-</span> beta<span class=hljs-operator >*</span>A <span class=hljs-operator >+</span> <span class=hljs-built_in >gamma</span><span class=hljs-operator >*</span>M <span class=hljs-operator >+</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  
  alpha_ <span class=hljs-operator >&lt;-</span> mean<span class=hljs-punctuation >(</span>M<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> mean<span class=hljs-punctuation >(</span>M<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >0</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  mod <span class=hljs-operator >&lt;-</span> lm<span class=hljs-punctuation >(</span>Y <span class=hljs-operator >~</span> A <span class=hljs-operator >+</span> M<span class=hljs-punctuation >)</span>
  beta_ <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >as.numeric</span><span class=hljs-punctuation >(</span>coef<span class=hljs-punctuation >(</span>mod<span class=hljs-punctuation >)</span><span class=hljs-punctuation >[</span><span class=hljs-string >&quot;A&quot;</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  gamma_ <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >as.numeric</span><span class=hljs-punctuation >(</span>coef<span class=hljs-punctuation >(</span>mod<span class=hljs-punctuation >)</span><span class=hljs-punctuation >[</span><span class=hljs-string >&quot;M&quot;</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  tau_ <span class=hljs-operator >&lt;-</span>  mean<span class=hljs-punctuation >(</span>Y<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> mean<span class=hljs-punctuation >(</span>Y<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >0</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  
  <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span><span class=hljs-string >&quot;total&quot;</span> <span class=hljs-operator >=</span> beta_ <span class=hljs-operator >+</span> alpha_<span class=hljs-operator >*</span>gamma_<span class=hljs-punctuation >,</span>
    <span class=hljs-string >&quot;direct&quot;</span> <span class=hljs-operator >=</span> beta_<span class=hljs-punctuation >,</span>
    <span class=hljs-string >&quot;indirect&quot;</span> <span class=hljs-operator >=</span> alpha_<span class=hljs-operator >*</span>gamma_<span class=hljs-punctuation >)</span>
<span class=hljs-punctuation >}</span></code></pre> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/causal-mediation_files/figure-html/unnamed-chunk-3-1.png" style="padding:0; width:100%" alt=" "/> <figcaption> </figcaption> </figure> <h3 id=1_a_confounded_mediation_model ><a href="#1_a_confounded_mediation_model" class=header-anchor >&#40;1&#41; A confounded mediation model</a></h3> <p>We now make M and Y to be shared caused of another variable <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>. This results in biased estimates of the direct and indirect effect as seen in the graph below.</p> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/mediationlinearconfounded.png" style="padding:0; width:100%" alt=" Linear mediation model with confounding (structural equation model): scenario 1"/> <figcaption> Linear mediation model with confounding (structural equation model): scenario 1</figcaption> </figure> <p>In this case the our estimate of the indirect effect is biased, too high, i.e. generally <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>α</mi><mo>^</mo></mover><mover accent=true ><mi>γ</mi><mo>^</mo></mover><mo>&gt;</mo><mi>α</mi><mi>γ</mi></mrow><annotation encoding="application/x-tex">\hat{\alpha}\hat{\gamma} &gt; \alpha\gamma</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >^</span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.25em;"><span class=mord >^</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span></span></span> while the direct effect is too low. If <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> is &gt;0 &#40;&lt;0&#41; then both M and Y are more likely to take a higher &#40;lower&#41; value which gets absorbed into the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>α</mi><mo>^</mo></mover><mover accent=true ><mi>γ</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{\alpha}\hat{\gamma}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.22222em;"><span class=mord >^</span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.69444em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05556em;">γ</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.25em;"><span class=mord >^</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.19444em;"><span></span></span></span></span></span></span></span></span> estimate. </p> <pre><code class="r hljs">mediation_scen1 <span class=hljs-operator >&lt;-</span> <span class=hljs-keyword >function</span><span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >,</span>alpha<span class=hljs-punctuation >,</span>beta<span class=hljs-punctuation >,</span><span class=hljs-built_in >gamma</span><span class=hljs-punctuation >)</span> <span class=hljs-punctuation >{</span>
  A <span class=hljs-operator >&lt;-</span> rbinom<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >,</span><span class=hljs-number >1</span><span class=hljs-punctuation >,</span><span class=hljs-number >0.5</span><span class=hljs-punctuation >)</span>
  U <span class=hljs-operator >&lt;-</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  M <span class=hljs-operator >&lt;-</span> alpha<span class=hljs-operator >*</span>A <span class=hljs-operator >+</span> U <span class=hljs-operator >+</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  Y <span class=hljs-operator >&lt;-</span> beta<span class=hljs-operator >*</span>A <span class=hljs-operator >+</span> <span class=hljs-built_in >gamma</span><span class=hljs-operator >*</span>M <span class=hljs-operator >+</span> U <span class=hljs-operator >+</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  
  alpha_ <span class=hljs-operator >&lt;-</span> mean<span class=hljs-punctuation >(</span>M<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> mean<span class=hljs-punctuation >(</span>M<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >0</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  mod <span class=hljs-operator >&lt;-</span> lm<span class=hljs-punctuation >(</span>Y <span class=hljs-operator >~</span> A <span class=hljs-operator >+</span> M<span class=hljs-punctuation >)</span>
  beta_ <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >as.numeric</span><span class=hljs-punctuation >(</span>coef<span class=hljs-punctuation >(</span>mod<span class=hljs-punctuation >)</span><span class=hljs-punctuation >[</span><span class=hljs-string >&quot;A&quot;</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  gamma_ <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >as.numeric</span><span class=hljs-punctuation >(</span>coef<span class=hljs-punctuation >(</span>mod<span class=hljs-punctuation >)</span><span class=hljs-punctuation >[</span><span class=hljs-string >&quot;M&quot;</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  tau_ <span class=hljs-operator >&lt;-</span>  mean<span class=hljs-punctuation >(</span>Y<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> mean<span class=hljs-punctuation >(</span>Y<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >0</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  
  <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span><span class=hljs-string >&quot;total&quot;</span> <span class=hljs-operator >=</span> beta_ <span class=hljs-operator >+</span> alpha_<span class=hljs-operator >*</span>gamma_<span class=hljs-punctuation >,</span>
    <span class=hljs-string >&quot;direct&quot;</span> <span class=hljs-operator >=</span> beta_<span class=hljs-punctuation >,</span>
    <span class=hljs-string >&quot;indirect&quot;</span> <span class=hljs-operator >=</span> alpha_<span class=hljs-operator >*</span>gamma_<span class=hljs-punctuation >)</span>
<span class=hljs-punctuation >}</span></code></pre> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/causal-mediation_files/figure-html/unnamed-chunk-5-1.png" style="padding:0; width:100%" alt=" "/> <figcaption> </figcaption> </figure> <h3 id=2_measured_confounding ><a href="#2_measured_confounding" class=header-anchor >&#40;2&#41; Measured confounding</a></h3> <p>If we knew there was confounding of <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span></span></span> by <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> and we measured <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span> we could estimate the direct and indirect effects while controlling for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>. This would fix our biases - see the graph&#33;</p> <pre><code class="r hljs">mediation_scen2 <span class=hljs-operator >&lt;-</span> <span class=hljs-keyword >function</span><span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >,</span>alpha<span class=hljs-punctuation >,</span>beta<span class=hljs-punctuation >,</span><span class=hljs-built_in >gamma</span><span class=hljs-punctuation >)</span> <span class=hljs-punctuation >{</span>
  A <span class=hljs-operator >&lt;-</span> rbinom<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >,</span><span class=hljs-number >1</span><span class=hljs-punctuation >,</span><span class=hljs-number >0.5</span><span class=hljs-punctuation >)</span>
  U <span class=hljs-operator >&lt;-</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  M <span class=hljs-operator >&lt;-</span> alpha<span class=hljs-operator >*</span>A <span class=hljs-operator >+</span> U <span class=hljs-operator >+</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  Y <span class=hljs-operator >&lt;-</span> beta<span class=hljs-operator >*</span>A <span class=hljs-operator >+</span> <span class=hljs-built_in >gamma</span><span class=hljs-operator >*</span>M <span class=hljs-operator >+</span> U <span class=hljs-operator >+</span> rnorm<span class=hljs-punctuation >(</span>N<span class=hljs-punctuation >)</span>
  
  alpha_ <span class=hljs-operator >&lt;-</span> mean<span class=hljs-punctuation >(</span>M<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> mean<span class=hljs-punctuation >(</span>M<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >0</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  mod <span class=hljs-operator >&lt;-</span> lm<span class=hljs-punctuation >(</span>Y <span class=hljs-operator >~</span> A <span class=hljs-operator >+</span> M <span class=hljs-operator >+</span> U<span class=hljs-punctuation >)</span>
  beta_ <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >as.numeric</span><span class=hljs-punctuation >(</span>coef<span class=hljs-punctuation >(</span>mod<span class=hljs-punctuation >)</span><span class=hljs-punctuation >[</span><span class=hljs-string >&quot;A&quot;</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  gamma_ <span class=hljs-operator >&lt;-</span> <span class=hljs-built_in >as.numeric</span><span class=hljs-punctuation >(</span>coef<span class=hljs-punctuation >(</span>mod<span class=hljs-punctuation >)</span><span class=hljs-punctuation >[</span><span class=hljs-string >&quot;M&quot;</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  tau_ <span class=hljs-operator >&lt;-</span>  mean<span class=hljs-punctuation >(</span>Y<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >1</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span> <span class=hljs-operator >-</span> mean<span class=hljs-punctuation >(</span>Y<span class=hljs-punctuation >[</span>A<span class=hljs-operator >==</span><span class=hljs-number >0</span><span class=hljs-punctuation >]</span><span class=hljs-punctuation >)</span>
  
  <span class=hljs-built_in >c</span><span class=hljs-punctuation >(</span><span class=hljs-string >&quot;total&quot;</span> <span class=hljs-operator >=</span> beta_ <span class=hljs-operator >+</span> alpha_<span class=hljs-operator >*</span>gamma_<span class=hljs-punctuation >,</span>
    <span class=hljs-string >&quot;direct&quot;</span> <span class=hljs-operator >=</span> beta_<span class=hljs-punctuation >,</span>
    <span class=hljs-string >&quot;indirect&quot;</span> <span class=hljs-operator >=</span> alpha_<span class=hljs-operator >*</span>gamma_<span class=hljs-punctuation >)</span>
<span class=hljs-punctuation >}</span></code></pre> <figure style="text-align:center;"> <img src="/assets/causal-mediation-20210202/causal-mediation_files/figure-html/unnamed-chunk-7-1.png" style="padding:0; width:100%" alt=" "/> <figcaption> </figcaption> </figure> <h2 id=conclusion ><a href="#conclusion" class=header-anchor >Conclusion </a></h2> <p>This post was a quick introduction to mediation analysis and one of the potential issues that can crop up - confounding of the mediator and outcome. Measure your confounders, achieve anything. Thanks for reading.</p> <h3 id=references ><a href="#references" class=header-anchor >References</a></h3> <ul> <li><p>Pearl, J. &#40;2014&#41;. Interpretation and identification of causal mediation. Psychological methods, 19&#40;4&#41;, 459: https://ftp.cs.ucla.edu/pub/stat_ser/r389.pdf </p> </ul> <script src="https://utteranc.es/client.js" repo="oizin/oizin.github.io" issue-term=title  label=Comment  theme=github-light  crossorigin=anonymous  async> </script> <div class=page-foot > <div class=copyright > &copy; Oisin Fitzgerald. Last modified: December 08, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <label for=sidebar-checkbox  class=sidebar-toggle ></label>